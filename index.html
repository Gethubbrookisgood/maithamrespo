<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ØªØ´ÙÙŠØ±ÙŠ â€” Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø´Ø®ØµÙŠØ©</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa6bf;--accent:#60a5fa;--glass:rgba(255,255,255,0.03);--success:#10b981;--warning:#f59e0b}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,'Noto Naskh Arabic',sans-serif;background:linear-gradient(180deg,#071027 0%,#081228 100%);color:#e6eef8}
    .wrap{max-width:1200px;margin:32px auto;padding:20px}
    h1{font-size:20px;margin:0 0 12px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .full-width{grid-column:1 / -1}
    .card{background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 24px rgba(2,6,23,0.6)}
    .encrypt-card{border-left:3px solid var(--accent)}
    .decrypt-card{border-left:3px solid var(--success)}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    textarea,input,select{width:100%;box-sizing:border-box;border-radius:8px;padding:10px;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);color:inherit}
    textarea{min-height:100px;resize:vertical}
    .row{display:flex;gap:8px}
    button{border:none;color:#fff;padding:10px 16px;border-radius:8px;cursor:pointer;font-weight:500;transition:all 0.2s}
    .btn-encrypt{background:var(--accent)}
    .btn-decrypt{background:var(--success)}
    .btn-clear{background:var(--warning)}
    .btn-download{background:#6b7280}
    button:hover{opacity:0.9;transform:translateY(-1px)}
    pre{white-space:pre-wrap;word-wrap:break-word;background:var(--glass);padding:12px;border-radius:8px;color:var(--muted);font-family:'Courier New',monospace;border:1px solid rgba(255,255,255,0.05)}
    .small{font-size:12px;color:var(--muted)}
    .foot{margin-top:12px;font-size:13px;color:var(--muted)}
    .section-title{font-size:16px;font-weight:600;margin:0 0 16px;color:#e6eef8;display:flex;align-items:center;gap:8px}
    .result-section{margin-top:16px;padding-top:16px;border-top:1px solid rgba(255,255,255,0.1)}
    .copy-btn{background:#374151;font-size:11px;padding:4px 8px;margin-left:8px}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>ØªØ´ÙÙŠØ±ÙŠ â€” Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ´ÙÙŠØ± Ø§Ù„Ø´Ø®ØµÙŠØ© (ØªØ¹Ù…Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ø­Ù„ÙŠÙ‹Ø§)</h1>
    <p class="small">Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ù…Ù„ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ ÙÙ‚Ø· â€” Ù„Ø§ ØªÙØ±ÙØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø£ÙŠ Ø®Ø§Ø¯Ù…. ÙŠØ­ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù„Ø­Ø±ÙˆÙ Ù„Ø§ØªÙŠÙ†ÙŠØ©ØŒ Ø«Ù… ÙŠØ­ÙˆÙ„ ÙƒÙ„ Ø­Ø±Ù Ù„Ø±Ù‚Ù… Ø¨Ø­Ø³Ø¨ ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ø¨Ø¬Ø¯ÙŠØ© Ø§Ù„Ù…Ø¹ÙƒÙˆØ³ (aâ†’26, bâ†’25, ..., zâ†’1) Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ù…ÙØªØ§Ø­ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†.</p>

    <div class="grid">
      <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ´ÙÙŠØ± -->
      <div class="card encrypt-card">
        <div class="section-title">ğŸ”’ ØªØ´ÙÙŠØ± Ø§Ù„Ù†Øµ</div>
        
        <label>Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ´ÙÙŠØ±Ù‡:</label>
        <textarea id="inputArabic" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù‡Ù†Ø§...
Ù…Ø«Ø§Ù„: Ù…Ø±Ø­Ø¨Ø§ Ø¨Ø§Ù„Ø¹Ø§Ù„Ù…"></textarea>

        <div style="margin-top:12px" class="row">
          <div style="flex:1">
            <label>Ù…ÙØªØ§Ø­ Ø§Ù„ØªØ´ÙÙŠØ±:</label>
            <input id="keyInput" type="number" value="42" />
          </div>
          <div style="width:150px">
            <label>ÙˆØ¶Ø¹ Ø§Ù„ØªØ¯ÙˆÙŠØ±:</label>
            <select id="modToggle">
              <option value="on">Ù…ÙØ¹Ù‘Ù„ (1-26)</option>
              <option value="off">Ù…Ø¹Ø·Ù‘Ù„</option>
            </select>
          </div>
        </div>

        <div style="margin-top:16px" class="row">
          <button class="btn-encrypt" id="encryptBtn">ğŸ”’ ØªØ´ÙÙŠØ±</button>
          <button class="btn-clear" id="clearEncryptBtn">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
        </div>

        <div class="result-section">
          <label>Ø§Ù„Ù†Øµ Ø¨Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠØ© (Transliteration):</label>
          <pre id="latinOut">-</pre>

          <label style="margin-top:12px">Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙØ± (Ø§Ù„Ø£Ø±Ù‚Ø§Ù…):
            <button class="copy-btn" id="copyEncrypted">Ù†Ø³Ø®</button>
          </label>
          <pre id="numbersOut">-</pre>
        </div>
      </div>

      <!-- Ù‚Ø³Ù… ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ± -->
      <div class="card decrypt-card">
        <div class="section-title">ğŸ”“ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±</div>
        
        <label>Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙØ± (Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù…ÙØµÙˆÙ„Ø© Ø¨Ù…Ø³Ø§ÙØ§Øª):</label>
        <textarea id="encryptedInput" placeholder="Ø£Ù„ØµÙ‚ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙØ± Ù‡Ù†Ø§...
Ù…Ø«Ø§Ù„: 68' 69' 70' 71'"></textarea>

        <div style="margin-top:12px" class="row">
          <div style="flex:1">
            <label>Ù…ÙØªØ§Ø­ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±:</label>
            <input id="decryptKeyInput" type="number" value="42" />
          </div>
          <div style="width:150px">
            <label>ÙˆØ¶Ø¹ Ø§Ù„ØªØ¯ÙˆÙŠØ±:</label>
            <select id="decryptModToggle">
              <option value="on">Ù…ÙØ¹Ù‘Ù„ (1-26)</option>
              <option value="off">Ù…Ø¹Ø·Ù‘Ù„</option>
            </select>
          </div>
        </div>

        <div style="margin-top:16px" class="row">
          <button class="btn-decrypt" id="decryptBtn">ğŸ”“ ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±</button>
          <button class="btn-clear" id="clearDecryptBtn">ğŸ—‘ï¸ Ù…Ø³Ø­</button>
        </div>

        <div class="result-section">
          <label>Ø§Ù„Ù†Øµ Ø§Ù„Ù…ÙÙƒÙˆÙƒ (Ù„Ø§ØªÙŠÙ†ÙŠ):
            <button class="copy-btn" id="copyDecrypted">Ù†Ø³Ø®</button>
          </label>
          <pre id="decryptedOut">-</pre>

          <label style="margin-top:12px">Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© (ØªÙ‚Ø±ÙŠØ¨ÙŠØ©):</label>
          <pre id="arabicOut">-</pre>
        </div>
      </div>
    </div>

    <!-- Ø£Ø²Ø±Ø§Ø± Ø¥Ø¶Ø§ÙÙŠØ© -->
    <div class="card full-width" style="margin-top:16px">
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <button class="btn-download" id="downloadBtn">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ HTML</button>
        <button class="btn-clear" id="clearAllBtn">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
      </div>
    </div>

    <!-- Ø´Ø±Ø­ Ø§Ù„Ø¢Ù„ÙŠØ© -->
    <div style="margin-top:16px" class="card full-width">
      <h3 style="margin-top:0">ğŸ“‹ Ø´Ø±Ø­ Ø¢Ù„ÙŠØ© Ø§Ù„ØªØ´ÙÙŠØ±</h3>
      <ul class="small">
        <li><strong>Ø§Ù„ØªØ´ÙÙŠØ±:</strong> ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© â†’ Ù„Ø§ØªÙŠÙ†ÙŠØ© â†’ Ø£Ø±Ù‚Ø§Ù… Ù…Ø¹ÙƒÙˆØ³Ø© (aâ†’26, zâ†’1) â†’ Ø¥Ø¶Ø§ÙØ© Ù…ÙØªØ§Ø­ Ø§Ù„Ø¯ÙˆØ±Ø§Ù†</li>
        <li><strong>ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±:</strong> Ø£Ø±Ù‚Ø§Ù… Ù…Ø´ÙØ±Ø© â†’ Ø·Ø±Ø­ Ù…ÙØªØ§Ø­ Ø§Ù„Ø¯ÙˆØ±Ø§Ù† â†’ ØªØ­ÙˆÙŠÙ„ Ù„Ø­Ø±ÙˆÙ Ù„Ø§ØªÙŠÙ†ÙŠØ© â†’ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø±Ø¬Ø§Ø¹ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©</li>
        <li><strong>ÙˆØ¶Ø¹ Ø§Ù„ØªØ¯ÙˆÙŠØ±:</strong> Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù„Ø§Ù‹ØŒ ØªØ¨Ù‚Ù‰ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø¨ÙŠÙ† 1-26ØŒ ÙˆØ¥Ù„Ø§ ÙÙ‚Ø¯ ØªØµØ¨Ø­ Ø£ÙƒØ¨Ø±</li>
        <li><strong>Ù…Ù„Ø§Ø­Ø¸Ø©:</strong> ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠØ© Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© ØªÙ‚Ø±ÙŠØ¨ÙŠ ÙˆÙ‚Ø¯ Ù„Ø§ ÙŠØ¹Ø·ÙŠ Ø§Ù„Ù†Øµ Ø§Ù„Ø£ØµÙ„ÙŠ Ø¨Ø¯Ù‚Ø©</li>
      </ul>
    </div>
  </div>

<script>
// Ø¬Ø¯ÙˆÙ„ ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¥Ù„Ù‰ Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠØ©
const arToLat = {
  'Ø§':'a','Ø£':'a','Ø¥':'a','Ø¢':'aa','Ø¨':'b','Øª':'t','Ø«':'th','Ø¬':'j','Ø­':'h','Ø®':'kh',
  'Ø¯':'d','Ø°':'dh','Ø±':'r','Ø²':'z','Ø³':'s','Ø´':'sh','Øµ':'s','Ø¶':'d','Ø·':'t','Ø¸':'z',
  'Ø¹':'a','Øº':'gh','Ù':'f','Ù‚':'q','Ùƒ':'k','Ù„':'l','Ù…':'m','Ù†':'n','Ù‡':'h','Ùˆ':'w','ÙŠ':'y',
  'Ù‰':'a','Ø¡':'','Ø¦':'','Ø¤':'','Ø©':'h','Ù‹':'','ÙŒ':'','Ù':'','Ù':'','Ù':'','Ù':'','Ù’':'','Ù‘':''
};

// Ø¬Ø¯ÙˆÙ„ Ø¹ÙƒØ³ÙŠ Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­ÙˆÙŠÙ„ Ù…Ù† Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠØ© Ù„Ù„Ø¹Ø±Ø¨ÙŠØ© (ØªÙ‚Ø±ÙŠØ¨ÙŠ)
const latToAr = {
  'a':'Ø§','b':'Ø¨','t':'Øª','j':'Ø¬','h':'Ù‡','d':'Ø¯','r':'Ø±','z':'Ø²','s':'Ø³',
  'f':'Ù','q':'Ù‚','k':'Ùƒ','l':'Ù„','m':'Ù…','n':'Ù†','w':'Ùˆ','y':'ÙŠ',
  'th':'Ø«','kh':'Ø®','dh':'Ø°','sh':'Ø´','gh':'Øº','aa':'Ø¢'
};

function transliterateArabic(text) {
  let out = '';
  for (let ch of text) {
    if (arToLat.hasOwnProperty(ch)) out += arToLat[ch];
    else if (/\s/.test(ch)) out += ' ';
    else out += ch;
  }
  return out.replace(/\s+/g, ' ').trim();
}

function transliterateToArabic(text) {
  let out = '';
  let i = 0;
  while (i < text.length) {
    // Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ù„Ø«Ù†Ø§Ø¦ÙŠØ§Øª Ø£ÙˆÙ„Ø§Ù‹
    let twoChar = text.substr(i, 2).toLowerCase();
    if (latToAr[twoChar]) {
      out += latToAr[twoChar];
      i += 2;
    } else {
      let oneChar = text[i].toLowerCase();
      if (latToAr[oneChar]) {
        out += latToAr[oneChar];
      } else if (/\s/.test(text[i])) {
        out += ' ';
      } else {
        out += text[i];
      }
      i += 1;
    }
  }
  return out.replace(/\s+/g, ' ').trim();
}

function reversedAlphaIndex(letter) {
  const a = letter.toLowerCase();
  if (a < 'a' || a > 'z') return null;
  const idx = a.charCodeAt(0) - 'a'.charCodeAt(0) + 1;
  return 27 - idx;
}

function indexToReversedAlpha(index) {
  const originalIdx = 27 - index;
  if (originalIdx < 1 || originalIdx > 26) return null;
  return String.fromCharCode('a'.charCodeAt(0) + originalIdx - 1);
}

function encryptText(arabicText, key, useModulo = true) {
  const latin = transliterateArabic(arabicText);
  const parts = [];
  
  for (let ch of latin) {
    if (/\s/.test(ch)) {
      parts.push('\n');
      continue;
    }
    
    const num = reversedAlphaIndex(ch);
    if (num === null) {
      parts.push(ch);
    } else {
      let v = num + Number(key);
      if (useModulo) {
        v = ((v - 1) % 26) + 1;
      }
      parts.push(String(v));
    }
  }
  
  return { latin: latin, numbers: parts };
}

function decryptNumbers(numbersText, key, useModulo = true) {
  // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù†Øµ ÙˆØªØ­ÙˆÙŠÙ„Ù‡ Ù„Ù…ØµÙÙˆÙØ© Ø£Ø±Ù‚Ø§Ù…
  const cleanText = numbersText.replace(/'/g, '').replace(/\n/g, ' \n ');
  const parts = cleanText.split(/\s+/).filter(s => s.length > 0);
  
  const chars = [];
  for (const p of parts) {
    if (p === '\n') {
      chars.push(' ');
      continue;
    }
    
    const n = Number(p);
    if (!Number.isFinite(n) || p.trim() === '') {
      chars.push(p);
      continue;
    }
    
    let v = n - Number(key);
    if (useModulo) {
      v = ((v - 1) % 26) + 1;
      if (v <= 0) v += 26;
    }
    
    const ch = indexToReversedAlpha(v);
    if (ch) {
      chars.push(ch);
    } else {
      chars.push('?');
    }
  }
  
  return chars.join('').replace(/\s+/g, ' ').trim();
}

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
const elements = {
  // Ø§Ù„ØªØ´ÙÙŠØ±
  inputArabic: document.getElementById('inputArabic'),
  keyInput: document.getElementById('keyInput'),
  modToggle: document.getElementById('modToggle'),
  encryptBtn: document.getElementById('encryptBtn'),
  clearEncryptBtn: document.getElementById('clearEncryptBtn'),
  latinOut: document.getElementById('latinOut'),
  numbersOut: document.getElementById('numbersOut'),
  
  // ÙÙƒ Ø§Ù„ØªØ´ÙÙŠØ±
  encryptedInput: document.getElementById('encryptedInput'),
  decryptKeyInput: document.getElementById('decryptKeyInput'),
  decryptModToggle: document.getElementById('decryptModToggle'),
  decryptBtn: document.getElementById('decryptBtn'),
  clearDecryptBtn: document.getElementById('clearDecryptBtn'),
  decryptedOut: document.getElementById('decryptedOut'),
  arabicOut: document.getElementById('arabicOut'),
  
  // Ø£Ø²Ø±Ø§Ø± Ø¥Ø¶Ø§ÙÙŠØ©
  downloadBtn: document.getElementById('downloadBtn'),
  clearAllBtn: document.getElementById('clearAllBtn'),
  copyEncrypted: document.getElementById('copyEncrypted'),
  copyDecrypted: document.getElementById('copyDecrypted')
};

// ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
elements.encryptBtn.addEventListener('click', () => {
  const key = Number(elements.keyInput.value) || 0;
  const useModulo = elements.modToggle.value === 'on';
  const result = encryptText(elements.inputArabic.value || '', key, useModulo);
  
  elements.latinOut.textContent = result.latin || '-';
  const numStr = result.numbers.map(x => 
    (x === '\n' ? "\n" : (typeof x === 'string' && /\D/.test(x) ? x : x + "'"))
  ).join(' ');
  elements.numbersOut.textContent = numStr || '-';
});

elements.decryptBtn.addEventListener('click', () => {
  const key = Number(elements.decryptKeyInput.value) || 0;
  const useModulo = elements.decryptModToggle.value === 'on';
  const encryptedText = elements.encryptedInput.value;
  
  if (!encryptedText.trim()) {
    alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø´ÙØ± Ø£ÙˆÙ„Ø§Ù‹');
    return;
  }
  
  const decrypted = decryptNumbers(encryptedText, key, useModulo);
  elements.decryptedOut.textContent = decrypted || '-';
  
  // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø¹Ø±Ø¨ÙŠØ©
  const arabic = transliterateToArabic(decrypted);
  elements.arabicOut.textContent = arabic || '-';
});

elements.clearEncryptBtn.addEventListener('click', () => {
  elements.inputArabic.value = '';
  elements.latinOut.textContent = '-';
  elements.numbersOut.textContent = '-';
});

elements.clearDecryptBtn.addEventListener('click', () => {
  elements.encryptedInput.value = '';
  elements.decryptedOut.textContent = '-';
  elements.arabicOut.textContent = '-';
});

elements.clearAllBtn.addEventListener('click', () => {
  elements.inputArabic.value = '';
  elements.encryptedInput.value = '';
  elements.latinOut.textContent = '-';
  elements.numbersOut.textContent = '-';
  elements.decryptedOut.textContent = '-';
  elements.arabicOut.textContent = '-';
});

elements.copyEncrypted.addEventListener('click', () => {
  const text = elements.numbersOut.textContent;
  if (text && text !== '-') {
    navigator.clipboard.writeText(text).then(() => {
      elements.copyEncrypted.textContent = 'âœ“ ØªÙ… Ø§Ù„Ù†Ø³Ø®';
      setTimeout(() => elements.copyEncrypted.textContent = 'Ù†Ø³Ø®', 2000);
    });
  }
});

elements.copyDecrypted.addEventListener('click', () => {
  const text = elements.decryptedOut.textContent;
  if (text && text !== '-') {
    navigator.clipboard.writeText(text).then(() => {
      elements.copyDecrypted.textContent = 'âœ“ ØªÙ… Ø§Ù„Ù†Ø³Ø®';
      setTimeout(() => elements.copyDecrypted.textContent = 'Ù†Ø³Ø®', 2000);
    });
  }
});

elements.downloadBtn.addEventListener('click', () => {
  const content = document.documentElement.outerHTML;
  const blob = new Blob([content], { type: 'text/html;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'tashfiri.html';
  a.click();
  URL.revokeObjectURL(url);
});

// Ù…Ø²Ø§Ù…Ù†Ø© Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ´ÙÙŠØ±
elements.keyInput.addEventListener('input', () => {
  elements.decryptKeyInput.value = elements.keyInput.value;
});

elements.decryptKeyInput.addEventListener('input', () => {
  elements.keyInput.value = elements.decryptKeyInput.value;
});

elements.modToggle.addEventListener('change', () => {
  elements.decryptModToggle.value = elements.modToggle.value;
});

elements.decryptModToggle.addEventListener('change', () => {
  elements.modToggle.value = elements.decryptModToggle.value;
});
</script>
</body>
</html>